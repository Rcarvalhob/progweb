define(["jquery","pubsub","shared.main.screen"],function(l,e,t){var i,a=WCS_CONFIG.get("topnav::utilityNavAsMultilineEnabled")||!1;return(i={defaults:{el:".topnav-mainnav",dataAttr:"mainnav-options",moreSelector:"> li.more",moreMenuSelector:".topnav-mainnav-more-menu",menuItemsSelector:"> li:not(.more)",promoBarSelector:".core-component-promo-bar",utilityNav:".topnav-utility",hideTextClass:"hide-text",multilineUtilityNavClass:"multiline-utility-nav",excludeBreakpoints:["small"],hasChildrenClassName:"has-children"},init:function(){var e=this;return e.deferred=l.Deferred(),e.$element=l(e.defaults.el),e.metadata=e.$element.data(e.defaults.dataAttr),e.config=l.extend({},e.defaults,e.metadata),e.$moreL1=l(e.config.moreSelector,e.$element),e.$moreMenu=l(e.config.moreMenuSelector,e.$element),e.$utilityNav=l(e.config.utilityNav),e.events(),"large"===e._getScreenSize()&&e.updateUtilityDisplay(),e.deferred.resolve(),e},getMoreLinkWidth:function(){var e,t=this.$moreL1;return t.hasClass("hide")?(t.css("left","-900000px").removeClass("hide"),e=t.outerWidth(!0),t.css("left","").addClass("hide")):e=t.outerWidth(!0),e},getAvailableSpace:function(e){var t=this,i=t.$element.outerWidth(),n=parseInt(t.$element.css("border-left-width"))||0,a=parseInt(t.$element.css("border-right-width"))||0,r=n+a,s=parseInt(t.$element.css("padding-left"))+parseInt(t.$element.css("padding-right")),o=parseInt(t.$element.css("margin-left"))+parseInt(t.$element.css("margin-right")),l=t.getMoreLinkWidth();return e&&(r=(n=Math.ceil(parseFloat(t.$element.css("border-left-width")))||0)+(a=Math.ceil(parseFloat(t.$element.css("border-right-width")))||0)),i-r-s-o-l},getNecessarySpace:function(){var t=0;return l(this.config.menuItemsSelector,this.$element).each(function(){var e=l(this).data("width");t+=e||l(this).outerWidth(!0)}),t},_getFirstMoreElement:function(){return l("li",this.$moreMenu).first()},_getLastMainElement:function(){return l(this.config.menuItemsSelector,this.$element).last()},getUtilityNavSize:function(){var e=this;if("large"===e._getScreenSize()||"medium"===e._getScreenSize()){var t=0,i=0,n=[];e.$utilityNav.find("li:visible").each(function(){var e=l(this).outerWidth(!0);t+=e,n.push(e)}),i+=parseInt(e.$utilityNav.css("padding-right")),i+=parseInt(e.$utilityNav.css("padding-left")),i+=parseInt(e.$utilityNav.css("margin-right")),i+=parseInt(e.$utilityNav.css("margin-left")),e.utilityNavSize={height:e.$utilityNav.outerHeight(!0),width:t+i,spacingWidth:i,itemsWidth:n},e.logoSize={height:l(".topnav-logo").outerHeight(!0),width:l(".topnav-logo").outerWidth(!0)},e.topnavHeight=l(".topnav-header").outerHeight(!0);var a=l(e.config.promoBarSelector);e.promoBarHeight=0<a.length?a.outerHeight():0}},_getScreenSize:function(){return t.size()},updateUtilityDisplay:function(){var e=this,t=l(window).width();if(e.utilityNavSize||e.getUtilityNavSize(),e.logoSize&&e.utilityNavSize&&Math.round(e.logoSize.height)>Math.round(e.topnavHeight-e.promoBarHeight-e.utilityNavSize.height)&&(t-=e.logoSize.width),a)if(("large"===e._getScreenSize()||"medium"===e._getScreenSize())&&t<e.utilityNavSize.width){var i=t-e.utilityNavSize.spacingWidth,n=e.getMultilineUtilityNavWidth(i);e.$utilityNav.css("width",n)}else e.$utilityNav.css("width","");else"large"===e._getScreenSize()&&t<e.utilityNavSize.width?e.$utilityNav.addClass(e.config.hideTextClass):e.$utilityNav.removeClass(e.config.hideTextClass)},getMultilineUtilityNavWidth:function(e){if(!this.utilityNavSize)return"";var t=this.utilityNavSize.itemsWidth,i=0;l.each(t,function(e,t){i+=t});for(var n=Math.ceil(i/e),a=i/n,r=0,s=0,o=0;o<t.length;o++)r+=t[o],(o<t.length-1&&r+t[o+1]>e||a<r||o===t.length-1)&&(s<r&&(s=r),r=0);return Math.min(e,s)},updateMainMenuItems:function(e){var t,i,n=this,a=n.getNecessarySpace(),r=n.getAvailableSpace();e=e||n._getScreenSize(),0<=n.config.excludeBreakpoints.indexOf(e)?0<(i=n._getFirstMoreElement()).length&&(n.insertIntoMainMenu(i),n.updateMainMenuItems(e)):r<a?0<(t=n._getLastMainElement()).length&&(t.attr("data-width",t.outerWidth(!0)),n.insertIntoMoreMenu(t),n.updateMainMenuItems(e)):a+(i=n._getFirstMoreElement()).data("width")<r&&(n.insertIntoMainMenu(i),n.updateMainMenuItems(e)),n.toggleMoreMenu(),l.pubsub("publish","vfdp.aem.topnav.moreMenu.updated")},insertIntoMoreMenu:function(e){e.prependTo(this.$moreMenu),e.hasClass("topnav-list")?l.pubsub("publish","vfdp.aem.topnav.moreMenu.add.list",e):l.pubsub("publish","vfdp.aem.topnav.moreMenu.add.dropdown",e)},insertIntoMainMenu:function(e){e.insertBefore(this.$moreL1),e.hasClass("topnav-list")?l.pubsub("publish","vfdp.aem.topnav.moreMenu.remove.list",e):l.pubsub("publish","vfdp.aem.topnav.moreMenu.remove.dropdown",e)},toggleMoreMenu:function(){var e=this;0<l("li",e.$moreMenu).length?e.$moreL1.removeClass("hide").addClass(e.config.hasChildrenClassName):e.$moreL1.addClass("hide").removeClass(e.config.hasChildrenClassName)},events:function(){var n=this;l.pubsub("subscribe","window.resize",function(e,t){var i=t?t.now:void 0;"large"!==i||n.utilityNavSize||n.getUtilityNavSize(),n.updateUtilityDisplay(),n.updateMainMenuItems(i)}),l.pubsub("subscribe","vfdp.aem.topnav.dropdown.loaded",function(e,t){n.updateMainMenuItems()}),l.pubsub("subscribe","vfdp.fonts.loaded",function(e,t){var i=t?t.now:void 0;n.getUtilityNavSize(),n.updateUtilityDisplay(),n.updateMainMenuItems(i)}),l.pubsub("subscribe","vfdp.topnav.sticky",function(e,t){var i=t?t.now:void 0;n.updateMainMenuItems(i)})}}).init(),i});
//# sourceMappingURL=../../../maps/js/cms/nav/mainNav.hash-6b40110e53b33b0a2c6249ed2f7f3aa3.js.map